@* Quick page to test Authentication of endpoints
   This can be used as a refrence on how to access
   BE endpoints and how auth attributes/tags *@

@page "/test-auth"
@attribute [Authorize]
@using Microsoft.AspNetCore.Authorization
@using System.Net.Http.Headers
@using Microsoft.AspNetCore.Components.Authorization
@using Plot.Data.Models.Auth.ResetPassword
@inject HttpClient Client
@inject AuthHeaderHttpClient AuthHeaderHttpClient
@inject NavigationManager Navigation
@inject IHttpContextAccessor HttpContextAccessor
@inject AuthService AuthService
@inject AuthHttpClient AuthHttpClient


<PageTitle>TestAuth</PageTitle>

<AuthorizeView Policy="Owner">
    <p>Auth Role: Owner</p>

</AuthorizeView>

<AuthorizeView Policy="Manager">
    <p>Auth Role: Manager</p>

</AuthorizeView>

<AuthorizeView Policy="Employee">
    <p>Auth Role: Employee</p>

</AuthorizeView>


<AuthorizeView>
    <NotAuthorized>
        <div>You are not authorized.</div>
    </NotAuthorized>
</AuthorizeView>


<h1>Hello Auth</h1>

<body class="background">
    <div class="login">
        <form class="body-content" onsubmit="@ResetPasswordRequestTest">
            
            <Button Class="Button" Id="buttonFail" Variant="primary" Icon="" Type="submit" IsDisabled=false
                TextAlignment="center">
                ResetPasswordRequest
            </Button>
            
        </form>
            
        
        <form class="body-content" onsubmit="@ResetPasswordTest">
            
            <Button Class="Button" Id="buttonPass" Variant="primary" Icon="" Type="submit" IsDisabled=false
                TextAlignment="center">
                ResetPassword
            </Button>
            
        
        </form>
        <form class="body-content" onsubmit="@RegisterTest">
            
            <Button Class="Button" Id="buttonPass" Variant="primary" Icon="" Type="submit" IsDisabled=false
                TextAlignment="center">
                NavigateAuth
            </Button>
            
        </form>
        <div class="footer-content">
        </div>
    </div>
</body>


@code
{

    private async void ResetPasswordRequestTest()
    {   
        ResetPasswordRequest newRequest = new ResetPasswordRequest
        {
            EMAIL = "example@example.com" // Replace with a valid email
        };

        var response = await AuthHttpClient.ResetPasswordRequest(newRequest);

        Console.WriteLine(response);
        
    }

    

    private async void ResetPasswordTest()
    {   
        ResetPasswordRequest newRequest = new ResetPasswordRequest
        {
            EMAIL = "example@example.com" // Replace with a valid email
        };

        var response = await AuthHttpClient.ResetPasswordRequest(newRequest);

        Console.WriteLine(response);
        
    }

    private async void RegisterTest()
    {   
        ResetPasswordRequest newRequest = new ResetPasswordRequest
        {
            EMAIL = "example@example.com" // Replace with a valid email
        };

        var response = await AuthHttpClient.ResetPasswordRequest(newRequest);

        Console.WriteLine(response);
        
    }


}