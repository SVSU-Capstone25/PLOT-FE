
@using Microsoft.AspNetCore.Components.Web
@inject IJSRuntime JS


<div class="ImageInput drag-drop-box" id="dropArea">
    <h5 class="text-decoration-underline my-auto text-center">
        <i class="fa-solid fa-image"></i> Drag & Drop or Click to Upload
    </h5>
    <input type="file" id="fileInput" class="d-none" onchange="onFileSelected(event)">
</div>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        console.log("DOMContentLoaded loaded!")
        const dropArea = document.getElementById("dropArea");
        const fileInput = document.getElementById("fileInput");

        dropArea.addEventListener("click", () => fileInput.click());

        dropArea.addEventListener("dragover", (event) => {
            event.preventDefault();
            dropArea.classList.add("drag-over");
            event.dataTransfer.dropEffect = "copy";
        });

        dropArea.addEventListener("dragleave", () => {
            dropArea.classList.remove("drag-over");
        });

        dropArea.addEventListener("drop", (event) => {
            event.preventDefault();
            dropArea.classList.remove("drag-over");
            
            if (event.dataTransfer.files.length > 0) {
                fileInput.files = event.dataTransfer.files;
                fileInput.dispatchEvent(new Event("change"));
            }
        });
    });

    function onFileSelected(event) {
        const file = event.target.files[0];
        if (file) {
            alert("Selected file: " + file.name);
        }
    }
</script>

@code {
    private ElementReference fileInput;
    
    [Parameter] public string Label { get; set; } = "Upload Image";  
    [Parameter, EditorRequired] public string Id { get; set; }
    [Parameter] public string? Class { get; set; } 
    [Parameter] public string? Width { get; set; } 
    [Parameter] public string? Length { get; set; } 
}
